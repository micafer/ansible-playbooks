# RedHat related OSs
- name: create epel.repo
  action: template src=ganglia/templates/epel.repo dest=/etc/yum.repos.d/epel.repo 
  only_if: $redhat_os

- name: Yum install ganglia-gmond
  action: yum pkg=ganglia-gmond state=installed
  only_if: $redhat_os

- name: configure gmond (REL6)
  action: template src=ganglia/templates/gmond.conf dest=/etc/ganglia/gmond.conf owner=root group=root
  notify:
      - restart gmond
  only_if: $redhat6_os

- name: configure gmond (REL5)
  action: template src=ganglia/templates/gmond.old.conf dest=/etc/gmond.conf owner=root group=root
  notify:
      - restart gmond
  only_if: $redhat5_os
      
- name: start gmond
  action: service name=gmond state=running
  only_if: $redhat_os

# Debian related OSs
- name: Apt install ganglia-monitor
  action: apt pkg=ganglia-monitor state=installed
  only_if: $debian_os
  
- name: configure ganglia-monitor
  action: template src=ganglia/templates/gmond.conf dest=/etc/ganglia/gmond.conf owner=root group=root
  notify:
      - restart ganglia-monitor
  only_if: $debian_os